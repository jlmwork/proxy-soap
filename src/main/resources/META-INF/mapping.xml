<?xml version="1.0" encoding="UTF-8"?>
<entity-mappings version="2.1"
                 xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence/orm http://xmlns.jcp.org/xml/ns/persistence/orm_2_1.xsd">
    <description>The minimal mappings for a persistent entity in XML.</description>
    <converter class="prototypes.ws.proxy.soap.repository.jpa.HeadersConverter"/>
    <entity name="SoapExchange" class="prototypes.ws.proxy.soap.io.SoapExchange" access="FIELD">
        <table name="T_SOAPEXCHANGE"/>
        <attributes>
            <!-- just specified special columns or ignored fields -->
            <id name="id"/>
            <basic name="time">
                <temporal>DATETIME</temporal>
            </basic>
            <basic name="from">
                <column name="ipFrom" />
            </basic>
            <basic name="requestHeaders" fetch="LAZY">
                <column name="REQUESTHEADERS" length="2048"/>
            </basic>
            <basic name="responseHeaders" fetch="LAZY">
                <column name="RESPONSEHEADERS" length="2048"/>
            </basic>
            <!-- requests & responses are no more transient as
            External storage has been implemented -->
            <basic name="request" fetch="LAZY">
                <column name="REQUEST_XML" length="512"/>
            </basic>
            <basic name="response" fetch="LAZY">
                <column name="RESPONSE_XML" length="512"/>
            </basic>
            <!--
            <transient name="requestSoapErrors"/>
            <transient name="responseSoapErrors"/>
            <transient name="requestXmlErrors"/>
            <transient name="responseXmlErrors"/>-->
        </attributes>
        <convert converter="prototypes.ws.proxy.soap.repository.jpa.HeadersConverter" attribute-name="requestHeaders"/>
        <convert converter="prototypes.ws.proxy.soap.repository.jpa.HeadersConverter" attribute-name="responseHeaders"/>
        <entity-listeners>
            <entity-listener class="prototypes.ws.proxy.soap.repository.jpa.ExternalStorageListener">
                <pre-persist method-name="marshall"/>
                <pre-update method-name="marshall"/>
                <post-load method-name="unmarshall"/>
                <post-update method-name="unmarshall"/>
            </entity-listener>
        </entity-listeners>
    </entity>
</entity-mappings>